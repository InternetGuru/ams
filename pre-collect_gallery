#!/bin/bash

gallery="git@gitlab.wr.cz:fit/bi-ble/gallery.git"
local_gallery="/tmp/gallery"
readme="${local_gallery}/README.md"

# Přidání klíče serveru a klienta
eval $( ssh-agent -s )
ssh-keyscan gitlab.wr.cz >> ~/.ssh/known_hosts
base64 -d <<< "${SSH_PRIVATE_KEY}" | ssh-add -

# První běh -> Naklonovat galerii, vytvořit README.md
if [[ ! -d "${local_gallery}" ]]; then
    git clone "${gallery}" "${local_gallery}"
    printf '%s\n\n' "# Galerie studentských prací BI-BLE" > "${readme}"
fi

git -C "${local_gallery}" remote set-url origin "${gallery}"
